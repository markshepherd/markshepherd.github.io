(this.webpackJsonpCovidStats=this.webpackJsonpCovidStats||[]).push([[0],{184:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),l=a(19),i=a.n(l),r=(a(85),a(10)),c=a(11),o=a(9),h=a(15),u=a(16),d=a(202),m=a(203),p=a(204),f=a(205),v=a(206),g=a(207),C=a(208),b=(a(42),function(){function e(){Object(r.a)(this,e),this.selectCount={},this.linlogCount=0,this.arrowCount=0}return Object(c.a)(e,[{key:"reportEvent",value:function(e,t,a){gtag("event",e,{event_category:t||"engagement",event_label:a,transport_type:"beacon"})}},{key:"reportOutboundLink",value:function(e){this.reportEvent("click","outbound",e)}},{key:"itemSelected",value:function(e){var t=this.selectCount[e]||0;t+=1,this.selectCount[e]=t,1===t?this.reportEvent("table_select_1",null,e):5===t&&this.reportEvent("table_select_5",null,e)}},{key:"linearLogToggleClicked",value:function(){this.linlogCount+=1,1===this.linlogCount?this.reportEvent("linlog_click_1"):5===this.linlogCount&&this.reportEvent("linlog_click_5")}},{key:"arrowClicked",value:function(){this.arrowCount+=1,1===this.arrowCount?this.reportEvent("arrow_click_1"):5===this.arrowCount&&this.reportEvent("arrow_click_5")}}]),e}());b.instance||(b.instance=new b);var k=b.instance,y={height:"0px",padding:"0px"},S={position:"relative",left:"70px",fontSize:"20px"},E={height:"500px",maxHeight:"500px",marginLeft:"10px",marginRight:"10px",borderRadius:"10px"},O=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(r.a)(this,a),(s=t.call(this,e)).selectedIndex=0,s.style=Object.assign({backgroundColor:e.backgroundColor},E),s.state={selection:s.props.list[s.selectedIndex].name,list:s.createSortedList("cases",!1),sortBy:"cases",sortAscending:!1},s.handleCellClick=s.handleCellClick.bind(Object(o.a)(s)),s.select=s.select.bind(Object(o.a)(s)),s.handleNextClick=s.handleNextClick.bind(Object(o.a)(s)),s.handlePrevClick=s.handlePrevClick.bind(Object(o.a)(s)),s.toggleSort=s.toggleSort.bind(Object(o.a)(s)),s.selectedRef=n.a.createRef(),s.tableContainerRef=n.a.createRef(),s}return Object(c.a)(a,[{key:"sortArray",value:function(e,t,a,s){for(var n=[],l=0;l<e.length;l+=1)n.push(Object.assign({},e[l]));return a?n.sort((function(e,a){return s?e[t]-a[t]:a[t]-e[t]})):n.sort((function(e,a){return e[t]<a[t]?s?-1:1:e[t]>a[t]?s?1:-1:0})),n}},{key:"select",value:function(e){this.setState({selection:e}),this.props.onSelected(e)}},{key:"handleCellClick",value:function(e,t){k.itemSelected(this.props.title,t),this.select(t)}},{key:"findSelectedIndex",value:function(){for(var e=0;e<this.state.list.length;e+=1)if(this.state.list[e].name===this.state.selection)return e}},{key:"handleNextClick",value:function(e){var t=this.findSelectedIndex();t<this.state.list.length-1&&(t+=1),this.select(this.state.list[t].name),k.arrowClicked()}},{key:"handlePrevClick",value:function(e){var t=this.findSelectedIndex();t>0&&(t-=1),this.select(this.state.list[t].name),k.arrowClicked()}},{key:"toggleSort",value:function(){"cases"===this.state.sortBy?this.setState({sortBy:"name",sortAscending:!0}):this.setState({sortBy:"cases",sortAscending:!1})}},{key:"createSortedList",value:function(e,t){return"cases"===e?this.sortArray(this.props.list,"cases",!0,t):this.sortArray(this.props.list,"name",!1,t)}},{key:"ensureSelectionVisible",value:function(){var e=this.tableContainerRef.current,t=this.selectedRef.current;if(t){var a=e.scrollHeight-e.scrollTopMax;t.offsetTop+t.offsetHeight<e.scrollTop+a&&t.offsetTop-t.offsetHeight>e.scrollTop||(this.selectedRef.current.scrollIntoView(),e.scrollTop<t.offsetTop+100&&e.scrollTop!==e.scrollTopMax&&this.tableContainerRef.current.scrollBy(0,-100))}}},{key:"listsEqual",value:function(e,t){return e.length===t.length&&(0===e.length||e[0].name===t[0].name)}},{key:"componentDidUpdate",value:function(e,t,a){var s=!this.listsEqual(e.list,this.props.list);(t.sortBy!==this.state.sortBy||t.sortAscending!==this.state.sortAscending||s)&&this.setState({list:this.createSortedList(this.state.sortBy,this.state.sortAscending)}),s&&(this.selectedIndex=0,this.select(this.state.list[this.selectedIndex].name)),this.ensureSelectionVisible()}},{key:"componentDidMount",value:function(){this.props.onSelected(this.state.selection)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{style:S},n.a.createElement(d.a,{href:"#",onClick:this.handlePrevClick},"\u25c0"),"\xa0",n.a.createElement(d.a,{href:"#",onClick:this.handleNextClick},"\u25b6")),n.a.createElement(m.a,{ref:this.tableContainerRef,style:this.style},n.a.createElement(p.a,{stickyHeader:!0,style:y,size:"small"},n.a.createElement(f.a,null,n.a.createElement(v.a,{style:y},n.a.createElement(g.a,{style:y,onClick:this.toggleSort,align:"left"},this.props.title,"name"===this.state.sortBy?"\u25b2":""),n.a.createElement(g.a,{style:y,onClick:this.toggleSort,align:"right"},"cases"===this.state.sortBy?"\u25bc":"","Cases"))),n.a.createElement(C.a,null,this.state.list.map((function(t){var a=t.name===e.state.selection;return n.a.createElement(v.a,{ref:a?e.selectedRef:null,selected:a,style:y,key:t.name,onClick:e.props.itemClick},n.a.createElement(g.a,{style:y,align:"left",onClick:function(a){return e.handleCellClick(a,t.name)}},t.name),n.a.createElement(g.a,{style:y,align:"right",onClick:function(a){return e.handleCellClick(a,t.name)}},t.cases))}))))))}}]),a}(n.a.Component),D=a(74),j=a(211),x=a(209),L=a(210),w={position:"absolute",left:"10px",top:"5px"},_={position:"relative",top:"0px"},T={height:"25px"},R=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,l=new Array(s),i=0;i<s;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).chartRef=n.a.createRef(),e.state={type:"linear"},e.handleLinearClick=function(){k.linearLogToggleClicked(),e.setState({type:"linear"})},e.handleLogClick=function(){k.linearLogToggleClicked(),e.setState({type:"logarithmic"})},e}return Object(c.a)(a,[{key:"createChartData",value:function(e){for(var t=[],a=[],s=[],n=[],l=[],i=0;i<e.timeline.length;i+=1){var r=e.timeline[i];t.push(r.date.replace(/2020-/,"")),a.push(r.cases),s.push(r.deaths),n.push(r.cumulativeCases),l.push(r.cumulativeDeaths)}return{labels:t,datasets:[{label:"Daily New Cases",backgroundColor:"000000",borderColor:"rgba(75,75,192,0.5)",borderWidth:2,fill:!1,data:a},{label:"Daily Deaths",backgroundColor:"#333333",borderColor:"rgba(75,150,75,0.5)",borderWidth:2,fill:!1,data:s},{label:"Cumulative Cases",backgroundColor:"#333333",borderColor:"rgba(200,200,100,0.5)",borderWidth:2,fill:!1,data:n},{label:"Cumulative Deaths",backgroundColor:"#333333",borderColor:"rgba(100,30,30,0.5)",borderWidth:2,fill:!1,data:l}]}}},{key:"render",value:function(){var e={animation:{duration:300},responsive:!0,maintainAspectRatio:!0,legend:{position:"top"},title:{display:!0,text:this.props.title},scales:{xAxes:[{display:!0}],yAxes:[{display:!0,type:this.state.type,ticks:{callback:function(e,t,a){return e}}}]}};return n.a.createElement("div",{style:_},n.a.createElement("div",{style:w},n.a.createElement(j.a,{value:this.state.type,onChange:this.handleRadioChange},n.a.createElement(x.a,{control:n.a.createElement(L.a,{color:"default"}),size:"small",style:T,value:"linear",label:"Linear",onClick:this.handleLinearClick}),n.a.createElement(x.a,{control:n.a.createElement(L.a,{color:"default"}),size:"small",style:T,value:"logarithmic",label:"Log",onClick:this.handleLogClick}))),this.props.series&&n.a.createElement(D.a,{ref:this.chartRef,options:e,data:this.createChartData(this.props.series)}))}}]),a}(n.a.Component),N=a(76),A=function(){function e(t,a){Object(r.a)(this,e),this.callback=a,this.readBigDataFile(t)}return Object(c.a)(e,[{key:"addToSeries",value:function(e,t){e.deaths+=t.deaths,e.cases+=t.cases;var a=e.timeline[t.date];a?(a.deaths+=t.deaths,a.cases+=t.cases,a.cumulativeCases+=t.cumulativeCases,a.cumulativeDeaths+=t.cumulativeDeaths):(a={date:t.date,cases:t.cases,deaths:t.deaths,cumulativeCases:t.cumulativeCases,cumulativeDeaths:t.cumulativeDeaths},e.timeline[t.date]=a)}},{key:"optimizeSeries",value:function(e){for(var t=Object.keys(e.timeline).sort(),a=[],s=0;s<t.length;s+=1)a.push(e.timeline[t[s]]);e.timeline=a}},{key:"receivedBigDataFile",value:function(t){for(var a,s,n,l,i,r,c={timeline:[],cases:0,deaths:0},o={},h=t.split(/[\n\r]+/),u=[],d=0;d<h.length;d+=1)6===(r=h[d].split(/,/)).length&&"date"!==r[0]&&u.push(r);u.sort((function(e,t){return e[2]>t[2]?1:e[2]<t[2]?-1:e[1]>t[1]?1:e[1]<t[1]?-1:e[0]>t[0]?1:e[0]<t[0]?-1:0}));for(var m=0;m<u.length;m+=1){var p=(r=u[m])[0],f=r[1],v=r[2],g=parseInt(r[4],10),C=parseInt(r[5],10);f===n&&v===l||(n=f,l=v,a=0,s=0);var b=a,k=s;a=g,s=C;var y={date:p,cases:g-=b,deaths:C-=k,cumulativeCases:a,cumulativeDeaths:s};this.addToSeries(c,y),(i=o[v])||(i={series:{timeline:[],cases:0,deaths:0},countiesData:{}},o[v]=i),this.addToSeries(i.series,y);var S=i.countiesData[f];S||(S={timeline:[],cases:0,deaths:0},i.countiesData[f]=S),this.addToSeries(S,y)}for(var E in o)for(var O in(i=o[E]).countiesData[e.allCounties]=i.series,delete i.series,i.countiesData)this.optimizeSeries(i.countiesData[O]);this.optimizeSeries(c),o[e.allStates]={countiesData:Object(N.a)({},e.allCounties,c)},this.callback({statesData:o})}},{key:"readBigDataFile",value:function(e){var t=this,a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){var e=a.status;0===e||e>=200&&e<400?t.receivedBigDataFile(a.responseText):alert("Couldn't fetch data file: status",e)}},a.open("GET",e),a.send()}}]),e}();A.allCounties=" All counties",A.allStates=" All states";var B=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(r.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).handleClick=function(){k.reportOutboundLink(e.props.href)},e}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement(d.a,{target:this.props.target,href:this.props.href,onClick:this.handleClick},this.props.children)}}]),a}(n.a.Component),I=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(r.a)(this,a),(s=t.call(this,e)).state={},s.calcStatesList=s.calcStatesList.bind(Object(o.a)(s)),s.calcCountiesList=s.calcCountiesList.bind(Object(o.a)(s)),s.handleStateSelected=s.handleStateSelected.bind(Object(o.a)(s)),s.handleCountySelected=s.handleCountySelected.bind(Object(o.a)(s)),s}return Object(c.a)(a,[{key:"calcStatesList",value:function(e){for(var t=[],a=Object.keys(e).sort(),s=0;s<a.length;s+=1){var n=a[s],l=e[n];t.push({name:n,cases:l.countiesData[A.allCounties].cases})}return t}},{key:"calcCountiesList",value:function(e,t){for(var a=e[t],s=[],n=Object.keys(a.countiesData).sort(),l=0;l<n.length;l+=1){var i=n[l],r=a.countiesData[i];s.push({name:i,cases:r.cases})}return s}},{key:"componentDidMount",value:function(){var e=this;this.covidData=new A("".concat("","us-counties-").concat("4-9-20",".csv"),(function(t){t.statesList=e.calcStatesList(t.statesData),e.setState(t)}))}},{key:"handleStateSelected",value:function(e){this.setState({selectedState:e})}},{key:"handleCountySelected",value:function(e){this.setState({selectedCounty:e})}},{key:"render",value:function(){var e=this.state.selectedCounty===A.allCounties?this.state.selectedState+","+this.state.selectedCounty:this.state.selectedState+", "+this.state.selectedCounty+" county";return n.a.createElement("div",{className:"app"},n.a.createElement("div",{className:"header"},n.a.createElement("span",{className:"myheader"},"Covid-19 Statistics by U.S. State and County"),n.a.createElement("br",null),"Last updated ","Apr 9, 2020","."),this.state.statesList&&n.a.createElement("div",{className:"state"},n.a.createElement(O,{backgroundColor:"#ffffe0",title:"State",list:this.state.statesList,onSelected:this.handleStateSelected})),this.state.selectedState&&n.a.createElement("div",{className:"county"},n.a.createElement(O,{backgroundColor:"#fffff4",title:"County",list:this.calcCountiesList(this.state.statesData,this.state.selectedState),onSelected:this.handleCountySelected})),this.state.selectedCounty&&n.a.createElement("div",{className:"chart"},n.a.createElement(R,{title:e,series:this.state.statesData[this.state.selectedState].countiesData[this.state.selectedCounty]})),n.a.createElement("div",{className:"notes"},n.a.createElement("div",{className:"notesText"},n.a.createElement("p",null,"Created by",n.a.createElement(B,{target:"_blank",href:"mailto:markcharts591@gmail.com"}," Mark Shepherd"),". The source code is ",n.a.createElement(B,{target:"_blank",href:"https://github.com/markshepherd/CovidStats"}," here"),". Data is provided by the ",n.a.createElement(B,{target:"_blank",href:"https://github.com/nytimes/covid-19-data"}," New York Times"),"."),n.a.createElement("p",null,"For the finest blend of country, gospel, and sea chanties, try",n.a.createElement(B,{target:"_blank",href:"https://larkdales.com/"}," The\xa0Larkdales"),"...")),n.a.createElement("div",{className:"socialIcons"},n.a.createElement(B,{target:"_blank",href:"https://twitter.com/MarkEShepherd"},n.a.createElement("img",{className:"socialIcon",align:"right",alt:"Go to Mark's Twitter",src:"".concat("","Twitter_Social_Icon_Circle_Color.svg")})),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(B,{target:"_blank",href:"https://open.spotify.com/album/7eAJ5qb0vFuN2K7iBrjbOu"},n.a.createElement("img",{className:"socialIcon",align:"right",alt:"Go to The Larkdales on Spotify",src:"".concat("","Spotify_Icon_RGB_Green.svg")})))))}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(183);i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},42:function(e,t,a){},80:function(e,t,a){e.exports=a(184)},85:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.3fdd3677.chunk.js.map